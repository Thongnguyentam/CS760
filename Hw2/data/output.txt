{
	"name": "KeyError",
	"message": "3",
	"stack": "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\indexes\\base.py:3361\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key, method, tolerance)\u001b[0m\n\u001b[0;32m   3360\u001b[0m \u001b[39mtry\u001b[39;00m:\n\u001b[1;32m-> 3361\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_engine\u001b[39m.\u001b[39;49mget_loc(casted_key)\n\u001b[0;32m   3362\u001b[0m \u001b[39mexcept\u001b[39;00m \u001b[39mKeyError\u001b[39;00m \u001b[39mas\u001b[39;00m err:\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\_libs\\index.pyx:76\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\_libs\\index.pyx:108\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n\nFile \u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi:2131\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.Int64HashTable.get_item\u001b[1;34m()\u001b[0m\n\nFile \u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi:2140\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.Int64HashTable.get_item\u001b[1;34m()\u001b[0m\n\n\u001b[1;31mKeyError\u001b[0m: 3\n\nThe above exception was the direct cause of the following exception:\n\n\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)\nCell \u001b[1;32mIn[402], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m df_d1 \u001b[39m=\u001b[39m pd\u001b[39m.\u001b[39mread_csv(\u001b[39m'\u001b[39m\u001b[39mdata/D1.txt\u001b[39m\u001b[39m'\u001b[39m, names \u001b[39m=\u001b[39m colname_d3, sep \u001b[39m=\u001b[39m \u001b[39m\"\u001b[39m\u001b[39m \u001b[39m\u001b[39m\"\u001b[39m)\n\u001b[1;32m----> 2\u001b[0m train_tree(df_d1,\u001b[39m'\u001b[39;49m\u001b[39my\u001b[39;49m\u001b[39m'\u001b[39;49m)\n\nCell \u001b[1;32mIn[399], line 14\u001b[0m, in \u001b[0;36mtrain_tree\u001b[1;34m(data, y)\u001b[0m\n\u001b[0;32m     12\u001b[0m     subtree[question]\u001b[39m.\u001b[39mappend(b) \u001b[39m#new\u001b[39;00m\n\u001b[0;32m     13\u001b[0m     \u001b[39mreturn\u001b[39;00m subtree \n\u001b[1;32m---> 14\u001b[0m yes_ans \u001b[39m=\u001b[39m train_tree(left, y) \n\u001b[0;32m     15\u001b[0m no_ans \u001b[39m=\u001b[39m train_tree(right, y)\n\u001b[0;32m     16\u001b[0m \u001b[39mprint\u001b[39m(yes_ans, no_ans)\n\nCell \u001b[1;32mIn[399], line 15\u001b[0m, in \u001b[0;36mtrain_tree\u001b[1;34m(data, y)\u001b[0m\n\u001b[0;32m     13\u001b[0m     \u001b[39mreturn\u001b[39;00m subtree \n\u001b[0;32m     14\u001b[0m yes_ans \u001b[39m=\u001b[39m train_tree(left, y) \n\u001b[1;32m---> 15\u001b[0m no_ans \u001b[39m=\u001b[39m train_tree(right, y)\n\u001b[0;32m     16\u001b[0m \u001b[39mprint\u001b[39m(yes_ans, no_ans)\n\u001b[0;32m     17\u001b[0m \u001b[39mif\u001b[39;00m yes_ans \u001b[39m==\u001b[39m no_ans:\n\nCell \u001b[1;32mIn[399], line 14\u001b[0m, in \u001b[0;36mtrain_tree\u001b[1;34m(data, y)\u001b[0m\n\u001b[0;32m     12\u001b[0m     subtree[question]\u001b[39m.\u001b[39mappend(b) \u001b[39m#new\u001b[39;00m\n\u001b[0;32m     13\u001b[0m     \u001b[39mreturn\u001b[39;00m subtree \n\u001b[1;32m---> 14\u001b[0m yes_ans \u001b[39m=\u001b[39m train_tree(left, y) \n\u001b[0;32m     15\u001b[0m no_ans \u001b[39m=\u001b[39m train_tree(right, y)\n\u001b[0;32m     16\u001b[0m \u001b[39mprint\u001b[39m(yes_ans, no_ans)\n\nCell \u001b[1;32mIn[399], line 15\u001b[0m, in \u001b[0;36mtrain_tree\u001b[1;34m(data, y)\u001b[0m\n\u001b[0;32m     13\u001b[0m     \u001b[39mreturn\u001b[39;00m subtree \n\u001b[0;32m     14\u001b[0m yes_ans \u001b[39m=\u001b[39m train_tree(left, y) \n\u001b[1;32m---> 15\u001b[0m no_ans \u001b[39m=\u001b[39m train_tree(right, y)\n\u001b[0;32m     16\u001b[0m \u001b[39mprint\u001b[39m(yes_ans, no_ans)\n\u001b[0;32m     17\u001b[0m \u001b[39mif\u001b[39;00m yes_ans \u001b[39m==\u001b[39m no_ans:\n\n    \u001b[1;31m[... skipping similar frames: train_tree at line 14 (13 times), train_tree at line 15 (5 times)]\u001b[0m\n\nCell \u001b[1;32mIn[399], line 15\u001b[0m, in \u001b[0;36mtrain_tree\u001b[1;34m(data, y)\u001b[0m\n\u001b[0;32m     13\u001b[0m     \u001b[39mreturn\u001b[39;00m subtree \n\u001b[0;32m     14\u001b[0m yes_ans \u001b[39m=\u001b[39m train_tree(left, y) \n\u001b[1;32m---> 15\u001b[0m no_ans \u001b[39m=\u001b[39m train_tree(right, y)\n\u001b[0;32m     16\u001b[0m \u001b[39mprint\u001b[39m(yes_ans, no_ans)\n\u001b[0;32m     17\u001b[0m \u001b[39mif\u001b[39;00m yes_ans \u001b[39m==\u001b[39m no_ans:\n\nCell \u001b[1;32mIn[399], line 14\u001b[0m, in \u001b[0;36mtrain_tree\u001b[1;34m(data, y)\u001b[0m\n\u001b[0;32m     12\u001b[0m     subtree[question]\u001b[39m.\u001b[39mappend(b) \u001b[39m#new\u001b[39;00m\n\u001b[0;32m     13\u001b[0m     \u001b[39mreturn\u001b[39;00m subtree \n\u001b[1;32m---> 14\u001b[0m yes_ans \u001b[39m=\u001b[39m train_tree(left, y) \n\u001b[0;32m     15\u001b[0m no_ans \u001b[39m=\u001b[39m train_tree(right, y)\n\u001b[0;32m     16\u001b[0m \u001b[39mprint\u001b[39m(yes_ans, no_ans)\n\nCell \u001b[1;32mIn[399], line 2\u001b[0m, in \u001b[0;36mtrain_tree\u001b[1;34m(data, y)\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mtrain_tree\u001b[39m(data, y):\n\u001b[1;32m----> 2\u001b[0m     var, val, ig, check \u001b[39m=\u001b[39m get_best_split(data, y)\n\u001b[0;32m      3\u001b[0m     \u001b[39mif\u001b[39;00m ig \u001b[39mis\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mNone\u001b[39;00m \u001b[39mand\u001b[39;00m ig \u001b[39m!=\u001b[39m \u001b[39m0\u001b[39m:\n\u001b[0;32m      4\u001b[0m         left, right \u001b[39m=\u001b[39m make_split(var, val, data)\n\nCell \u001b[1;32mIn[395], line 3\u001b[0m, in \u001b[0;36mget_best_split\u001b[1;34m(x, out)\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39mget_best_split\u001b[39m(x, out):\n\u001b[0;32m      2\u001b[0m     masks \u001b[39m=\u001b[39m x\u001b[39m.\u001b[39mdrop(out, axis \u001b[39m=\u001b[39m \u001b[39m1\u001b[39m)\u001b[39m.\u001b[39mapply(max_info_gain, y \u001b[39m=\u001b[39m x[out])\n\u001b[1;32m----> 3\u001b[0m     \u001b[39mif\u001b[39;00m np\u001b[39m.\u001b[39msum(masks\u001b[39m.\u001b[39;49mloc[\u001b[39m3\u001b[39;49m, :]) \u001b[39m==\u001b[39m \u001b[39m0\u001b[39m:\n\u001b[0;32m      4\u001b[0m         \u001b[39mreturn\u001b[39;00m (\u001b[39mNone\u001b[39;00m, \u001b[39mNone\u001b[39;00m, \u001b[39mFalse\u001b[39;00m, \u001b[39mNone\u001b[39;00m)\n\u001b[0;32m      5\u001b[0m     \u001b[39melse\u001b[39;00m:\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\indexing.py:925\u001b[0m, in \u001b[0;36m_LocationIndexer.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m    923\u001b[0m         \u001b[39mwith\u001b[39;00m suppress(\u001b[39mKeyError\u001b[39;00m, \u001b[39mIndexError\u001b[39;00m):\n\u001b[0;32m    924\u001b[0m             \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mobj\u001b[39m.\u001b[39m_get_value(\u001b[39m*\u001b[39mkey, takeable\u001b[39m=\u001b[39m\u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_takeable)\n\u001b[1;32m--> 925\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_getitem_tuple(key)\n\u001b[0;32m    926\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[0;32m    927\u001b[0m     \u001b[39m# we by definition only have the 0th axis\u001b[39;00m\n\u001b[0;32m    928\u001b[0m     axis \u001b[39m=\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39maxis \u001b[39mor\u001b[39;00m \u001b[39m0\u001b[39m\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\indexing.py:1100\u001b[0m, in \u001b[0;36m_LocIndexer._getitem_tuple\u001b[1;34m(self, tup)\u001b[0m\n\u001b[0;32m   1098\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39m_getitem_tuple\u001b[39m(\u001b[39mself\u001b[39m, tup: \u001b[39mtuple\u001b[39m):\n\u001b[0;32m   1099\u001b[0m     \u001b[39mwith\u001b[39;00m suppress(IndexingError):\n\u001b[1;32m-> 1100\u001b[0m         \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_getitem_lowerdim(tup)\n\u001b[0;32m   1102\u001b[0m     \u001b[39m# no multi-index, so validate all of the indexers\u001b[39;00m\n\u001b[0;32m   1103\u001b[0m     \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_has_valid_tuple(tup)\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\indexing.py:838\u001b[0m, in \u001b[0;36m_LocationIndexer._getitem_lowerdim\u001b[1;34m(self, tup)\u001b[0m\n\u001b[0;32m    834\u001b[0m \u001b[39mfor\u001b[39;00m i, key \u001b[39min\u001b[39;00m \u001b[39menumerate\u001b[39m(tup):\n\u001b[0;32m    835\u001b[0m     \u001b[39mif\u001b[39;00m is_label_like(key):\n\u001b[0;32m    836\u001b[0m         \u001b[39m# We don't need to check for tuples here because those are\u001b[39;00m\n\u001b[0;32m    837\u001b[0m         \u001b[39m#  caught by the _is_nested_tuple_indexer check above.\u001b[39;00m\n\u001b[1;32m--> 838\u001b[0m         section \u001b[39m=\u001b[39m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_getitem_axis(key, axis\u001b[39m=\u001b[39;49mi)\n\u001b[0;32m    840\u001b[0m         \u001b[39m# We should never have a scalar section here, because\u001b[39;00m\n\u001b[0;32m    841\u001b[0m         \u001b[39m#  _getitem_lowerdim is only called after a check for\u001b[39;00m\n\u001b[0;32m    842\u001b[0m         \u001b[39m#  is_scalar_access, which that would be.\u001b[39;00m\n\u001b[0;32m    843\u001b[0m         \u001b[39mif\u001b[39;00m section\u001b[39m.\u001b[39mndim \u001b[39m==\u001b[39m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mndim:\n\u001b[0;32m    844\u001b[0m             \u001b[39m# we're in the middle of slicing through a MultiIndex\u001b[39;00m\n\u001b[0;32m    845\u001b[0m             \u001b[39m# revise the key wrt to `section` by inserting an _NS\u001b[39;00m\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\indexing.py:1164\u001b[0m, in \u001b[0;36m_LocIndexer._getitem_axis\u001b[1;34m(self, key, axis)\u001b[0m\n\u001b[0;32m   1162\u001b[0m \u001b[39m# fall thru to straight lookup\u001b[39;00m\n\u001b[0;32m   1163\u001b[0m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_validate_key(key, axis)\n\u001b[1;32m-> 1164\u001b[0m \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49m_get_label(key, axis\u001b[39m=\u001b[39;49maxis)\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\indexing.py:1113\u001b[0m, in \u001b[0;36m_LocIndexer._get_label\u001b[1;34m(self, label, axis)\u001b[0m\n\u001b[0;32m   1111\u001b[0m \u001b[39mdef\u001b[39;00m \u001b[39m_get_label\u001b[39m(\u001b[39mself\u001b[39m, label, axis: \u001b[39mint\u001b[39m):\n\u001b[0;32m   1112\u001b[0m     \u001b[39m# GH#5667 this will fail if the label is not present in the axis.\u001b[39;00m\n\u001b[1;32m-> 1113\u001b[0m     \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39;49m\u001b[39m.\u001b[39;49mobj\u001b[39m.\u001b[39;49mxs(label, axis\u001b[39m=\u001b[39;49maxis)\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\generic.py:3776\u001b[0m, in \u001b[0;36mNDFrame.xs\u001b[1;34m(self, key, axis, level, drop_level)\u001b[0m\n\u001b[0;32m   3774\u001b[0m         \u001b[39mraise\u001b[39;00m \u001b[39mTypeError\u001b[39;00m(\u001b[39mf\u001b[39m\u001b[39m\"\u001b[39m\u001b[39mExpected label or tuple of labels, got \u001b[39m\u001b[39m{\u001b[39;00mkey\u001b[39m}\u001b[39;00m\u001b[39m\"\u001b[39m) \u001b[39mfrom\u001b[39;00m \u001b[39me\u001b[39;00m\n\u001b[0;32m   3775\u001b[0m \u001b[39melse\u001b[39;00m:\n\u001b[1;32m-> 3776\u001b[0m     loc \u001b[39m=\u001b[39m index\u001b[39m.\u001b[39;49mget_loc(key)\n\u001b[0;32m   3778\u001b[0m     \u001b[39mif\u001b[39;00m \u001b[39misinstance\u001b[39m(loc, np\u001b[39m.\u001b[39mndarray):\n\u001b[0;32m   3779\u001b[0m         \u001b[39mif\u001b[39;00m loc\u001b[39m.\u001b[39mdtype \u001b[39m==\u001b[39m np\u001b[39m.\u001b[39mbool_:\n\nFile \u001b[1;32mc:\\Python39\\lib\\site-packages\\pandas\\core\\indexes\\base.py:3363\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key, method, tolerance)\u001b[0m\n\u001b[0;32m   3361\u001b[0m         \u001b[39mreturn\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39m_engine\u001b[39m.\u001b[39mget_loc(casted_key)\n\u001b[0;32m   3362\u001b[0m     \u001b[39mexcept\u001b[39;00m \u001b[39mKeyError\u001b[39;00m \u001b[39mas\u001b[39;00m err:\n\u001b[1;32m-> 3363\u001b[0m         \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(key) \u001b[39mfrom\u001b[39;00m \u001b[39merr\u001b[39;00m\n\u001b[0;32m   3365\u001b[0m \u001b[39mif\u001b[39;00m is_scalar(key) \u001b[39mand\u001b[39;00m isna(key) \u001b[39mand\u001b[39;00m \u001b[39mnot\u001b[39;00m \u001b[39mself\u001b[39m\u001b[39m.\u001b[39mhasnans:\n\u001b[0;32m   3366\u001b[0m     \u001b[39mraise\u001b[39;00m \u001b[39mKeyError\u001b[39;00m(key)\n\n\u001b[1;31mKeyError\u001b[0m: 3"
}